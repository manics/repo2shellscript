dist: bionic
language: python
cache: pip

install:
  - pip install --upgrade pip
  - pip install -r dev-requirements.txt
  - pip install .
  - (cd $HOME/bin && wget -q https://releases.hashicorp.com/packer/1.6.1/packer_1.6.1_linux_amd64.zip && unzip packer_1.6.1_linux_amd64.zip && rm packer_1.6.1_linux_amd64.zip)

jobs:
  include:
    - stage: test
      script:
        - pre-commit run --all-files
    - stage: test
      python:
        - 3.6
      script: ./travis-test.sh
    - stage: test
      python:
        - 3.8
      script: ./travis-test.sh

    # - stage: deploy
    #   if: tag IS present
    #   deploy:
    #     - provider: pypi
    #       user: __token__
    #       # password: $PYPI_PASSWORD
    #       distributions: sdist bdist_wheel
    #       on:
    #         tags: true
